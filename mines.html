<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TON Casino - Mines</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .mines-game-page {
            background: linear-gradient(135deg, #f8fbff 0%, #f0f7ff 100%);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid rgba(42, 171, 238, 0.15);
        }

        .mines-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .mines-title {
            font-size: 24px;
            font-weight: 800;
            color: #1a1a1a;
        }

        .mines-game-rules {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 24px;
            border: 2px solid #e6f4ff;
        }

        .mines-settings {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            border: 2px solid #e6f4ff;
            box-shadow: 0 4px 15px rgba(42, 171, 238, 0.1);
        }

        .mines-settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .mines-settings-row:last-child {
            margin-bottom: 0;
        }

        .mines-settings-label {
            font-size: 14px;
            font-weight: 600;
            color: #1a1a1a;
        }

        .mines-settings-value {
            font-size: 14px;
            color: #666;
            font-weight: 600;
        }

        .mines-slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: #e6f4ff;
            border-radius: 3px;
            outline: none;
            margin: 12px 0;
        }

        .mines-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #2aabee;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(42, 171, 238, 0.3);
            border: 3px solid white;
        }

        .mines-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #2aabee;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(42, 171, 238, 0.3);
            border: 3px solid white;
        }

        .mines-display {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 8px;
        }

        .mine-indicator {
            width: 12px;
            height: 12px;
            background: #2aabee;
            border-radius: 50%;
            opacity: 0.3;
            position: relative;
        }

        .mine-indicator.active {
            opacity: 1;
            background: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .mine-indicator.active::before {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            mask: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 11.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>') no-repeat center;
            mask-size: contain;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .mines-bet-input-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            border: 2px solid #e6f4ff;
            box-shadow: 0 4px 15px rgba(42, 171, 238, 0.1);
        }

        .mines-bet-input-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #1a1a1a;
            text-align: center;
        }

        .mines-bet-input-container {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .mines-bet-input {
            flex: 1;
            padding: 16px;
            border: 2px solid #e6f4ff;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #1a1a1a;
            transition: all 0.3s;
        }

        .mines-bet-input:focus {
            outline: none;
            border-color: #2aabee;
            box-shadow: 0 0 0 3px rgba(42, 171, 238, 0.1);
        }

        .mines-bet-input-btn {
            padding: 16px 24px;
            background: linear-gradient(135deg, #2aabee 0%, #229ed9 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .mines-bet-input-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 171, 238, 0.3);
        }

        .mines-bet-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .mines-bet-btn {
            padding: 12px;
            background: white;
            border: 2px solid #e6f4ff;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 700;
            color: #2aabee;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .mines-bet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 171, 238, 0.2);
            border-color: #2aabee;
        }

        .mines-bet-btn.active {
            background: linear-gradient(135deg, #2aabee 0%, #229ed9 100%);
            border-color: #2aabee;
            color: white;
            box-shadow: 0 4px 12px rgba(42, 171, 238, 0.3);
        }

        .mines-game-field {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            border: 2px solid #e6f4ff;
            box-shadow: 0 4px 15px rgba(42, 171, 238, 0.1);
        }

        .mines-grid-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #1a1a1a;
            text-align: center;
        }

        .mines-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .mines-cell {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #f8fbff 0%, #f0f7ff 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #e6f4ff;
            font-weight: 700;
            font-size: 14px;
            color: #2aabee;
            position: relative;
            overflow: hidden;
        }

        .mines-cell:hover:not(.opened):not(.mine):not(.flag) {
            transform: scale(0.95);
            border-color: #2aabee;
            box-shadow: 0 4px 12px rgba(42, 171, 238, 0.2);
        }

        .mines-cell.opened {
            background: white;
            border-color: #2aabee;
            color: #1a1a1a;
        }

        .mines-cell.mine {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            border-color: #ff6b6b;
            color: white;
        }

        .mines-cell.mine::before {
            content: '';
            position: absolute;
            width: 70%;
            height: 70%;
            background: white;
            mask: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 11.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>') no-repeat center;
            mask-size: contain;
        }

        .mines-cell.flag {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            border-color: #4CAF50;
            color: white;
        }

        .mines-cell.flag::before {
            content: '';
            position: absolute;
            width: 60%;
            height: 60%;
            background: white;
            mask: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>') no-repeat center;
            mask-size: contain;
        }

        .mines-cell.gem {
            background: linear-gradient(135deg, #FFD700 0%, #FFC107 100%);
            border-color: #FFC107;
            color: white;
        }

        .mines-cell.gem::before {
            content: '';
            position: absolute;
            width: 60%;
            height: 60%;
            background: white;
            mask: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M16 9l4.371 1.749-1.619 4.232L16 13l-2.752 1.981L11.629 10.75 16 9zm-5.75 3.5L12 13.088l1.75-1.256L12 10.912l-1.75 1.256zM16 3l4 2v5l-4-2 4 2v5l-4-2-4 2-4-2-4 2-4-2 4-2V5l4 2V3l4-2 4 2z"/></svg>') no-repeat center;
            mask-size: contain;
        }

        .mines-cell.empty {
            background: white;
            border-color: #e6f4ff;
        }

        .mines-cell.empty::before {
            content: '';
            position: absolute;
            width: 60%;
            height: 60%;
            background: #e6f4ff;
            mask: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%23e6f4ff" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>') no-repeat center;
            mask-size: contain;
        }

        .mines-game-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .mines-info-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            border: 2px solid #e6f4ff;
            text-align: center;
        }

        .mines-info-value {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .mines-info-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .mines-multiplier {
            color: #4CAF50;
        }

        .mines-potential-win {
            color: #2aabee;
        }

        .mines-game-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            align-items: center;
        }

        .mines-control-button {
            flex: 1;
            padding: 16px 12px;
            border: none;
            border-radius: 16px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            min-width: 0;
            word-break: break-word;
        }
        
        .mines-start-button {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }

        .mines-start-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }

        .mines-start-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none !important;
        }

        .mines-cashout-button {
            background: linear-gradient(135deg, #2aabee 0%, #229ed9 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(42, 171, 238, 0.3);
        }

        .mines-cashout-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(42, 171, 238, 0.4);
        }

        .mines-cashout-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none !important;
        }

        .mines-flag-button {
            background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.3);
            min-width: 50px;
        }

        .mines-flag-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4);
        }

        .mines-flag-button.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.3);
        }

        .mines-control-icon {
            width: 18px;
            height: 18px;
            background: white;
            mask-size: contain;
            mask-repeat: no-repeat;
            mask-position: center;
            flex-shrink: 0;
        }
        
        .mines-start-icon {
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M8 5v14l11-7z"/></svg>');
        }

        .mines-cashout-icon {
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-6-7h3v-2h-3V8l-4 4 4 4v-3z"/></svg>');
        }

        .mines-flag-icon {
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>');
        }

        @keyframes cellReveal {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .mines-cell.revealed {
            animation: cellReveal 0.3s ease-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .mines-pulse {
            animation: pulse 0.5s ease-in-out;
        }

        @keyframes gemGlow {
            0% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
            100% { opacity: 0.7; transform: scale(1); }
        }

        .mines-cell.gem::before {
            animation: gemGlow 1.5s ease-in-out infinite;
        }

        @keyframes minePulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        .mines-cell.mine::before {
            animation: minePulse 1s ease-in-out infinite;
        }

        @media (max-width: 480px) {
            .mines-game-controls {
                flex-direction: row;
                flex-wrap: nowrap;
                gap: 8px;
            }
            
            .mines-flag-button {
                min-width: 40px;
                width: 40px;
                height: 50px;
            }
            
            .mines-control-button {
                padding: 12px 8px;
                font-size: 14px;
            }
            
            .mines-bet-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .mines-bet-input-container {
                flex-direction: column;
            }
            
            .mines-grid {
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-panel">
            <button class="back-button" onclick="window.location.href='index.html'">
                <span class="back-icon"></span>
                –ù–∞–∑–∞–¥
            </button>
            <div class="balance-btn" onclick="window.location.href='payments.html'">
                <span class="balance-icon"></span>
                <span id="balanceAmount">1500 TON</span>
            </div>
        </div>

        <div class="content">
            <div class="mines-game-page">
                <div class="mines-header">
                    <h2 class="mines-title">Mines Game</h2>
                </div>

                <div class="mines-game-rules">
                    <div class="rules-title">
                        <span class="rules-icon"></span>
                        –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
                    </div>
                    <ul class="rules-list">
                        <li>–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –º–Ω–æ–∂–∏—Ç–µ–ª—å</li>
                        <li>–ò–∑–±–µ–≥–∞–π—Ç–µ –º–∏–Ω - –æ–Ω–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç –∏–≥—Ä—É</li>
                        <li>–ß–µ–º –±–æ–ª—å—à–µ –º–∏–Ω, —Ç–µ–º –≤—ã—à–µ –º–Ω–æ–∂–∏—Ç–µ–ª—å</li>
                        <li>–ó–∞–±–µ—Ä–∏—Ç–µ –≤—ã–∏–≥—Ä—ã—à –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç</li>
                        <li>–ú–æ–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å —Ñ–ª–∞–∂–∫–∏ –Ω–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–µ –º–∏–Ω—ã</li>
                        <li>–®–∞–Ω—Å –ø–æ–ø–∞—Å—Ç—å –Ω–∞ –º–∏–Ω—É: 65%</li>
                    </ul>
                </div>

                <div class="mines-settings">
                    <div class="mines-settings-row">
                        <div class="mines-settings-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω:</div>
                        <div class="mines-settings-value" id="minesCount">3</div>
                    </div>
                    <input type="range" min="1" max="24" value="3" class="mines-slider" id="minesSlider">
                    <div class="mines-display" id="minesDisplay">
                        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º–∏–Ω –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    
                    <div class="mines-settings-row">
                        <div class="mines-settings-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –∑–∞ –∫–ª–µ—Ç–∫—É:</div>
                        <div class="mines-settings-value" id="multiplierPerCell">1.25x</div>
                    </div>
                </div>

                <!-- –í–≤–æ–¥ —Å—Ç–∞–≤–∫–∏ -->
                <div class="mines-bet-input-section">
                    <div class="mines-bet-input-title">–í–∞—à–∞ —Å—Ç–∞–≤–∫–∞ (TON)</div>
                    <div class="mines-bet-input-container">
                        <input type="number" class="mines-bet-input" id="minesBetInput" value="0.3" min="0.3" step="0.1" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
                        <button class="mines-bet-input-btn" id="minesSetBetButton">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    <div class="mines-bet-buttons">
                        <button class="mines-bet-btn" data-bet="0.3">0.3 TON</button>
                        <button class="mines-bet-btn" data-bet="1">1 TON</button>
                        <button class="mines-bet-btn" data-bet="5">5 TON</button>
                        <button class="mines-bet-btn" data-bet="10">10 TON</button>
                    </div>
                </div>

                <!-- –ü–æ–ª–µ –∏–≥—Ä—ã -->
                <div class="mines-game-field">
                    <div class="mines-grid-title">
                        <span id="minesCellsOpened">0</span> / <span id="minesTotalCells">25</span> –∫–ª–µ—Ç–æ–∫ –æ—Ç–∫—Ä—ã—Ç–æ
                    </div>
                    <div class="mines-grid" id="minesGrid">
                        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ 5x5 –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ JS -->
                    </div>
                </div>

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∏–≥—Ä–µ -->
                <div class="mines-game-info">
                    <div class="mines-info-card">
                        <div class="mines-info-value mines-multiplier" id="minesCurrentMultiplier">1.00x</div>
                        <div class="mines-info-label">–¢–µ–∫—É—â–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                    </div>
                    <div class="mines-info-card">
                        <div class="mines-info-value mines-potential-win" id="minesPotentialWin">0 TON</div>
                        <div class="mines-info-label">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à</div>
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π -->
                <div class="mines-game-controls">
                    <button class="mines-control-button mines-flag-button" id="minesFlagButton">
                        <span class="mines-control-icon mines-flag-icon"></span>
                    </button>
                    <button class="mines-control-button mines-start-button" id="minesStartButton">
                        <span class="mines-control-icon mines-start-icon"></span>
                        –ù–∞—á–∞—Ç—å
                    </button>
                    <button class="mines-control-button mines-cashout-button" id="minesCashoutButton" disabled>
                        <span class="mines-control-icon mines-cashout-icon"></span>
                        –ó–∞–±—Ä–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
        
        <div class="bottom-nav">
            <div class="nav-item" onclick="window.location.href='index.html'">
                <div class="nav-icon game"></div>
                <div>–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            <div class="nav-item" onclick="window.location.href='stats.html'">
                <div class="nav-icon stats"></div>
                <div>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            </div>
            <div class="nav-item" onclick="window.location.href='payments.html'">
                <div class="nav-icon withdraw"></div>
                <div>–í—ã–≤–æ–¥</div>
            </div>
        </div>
    </div>

    <script src="common.js"></script>
    <script>
        // ==================== –ü–ï–†–ï–ú–ï–ù–ù–´–ï MINES ====================
        let minesCurrentBet = 0.3;
        let minesGameActive = false;
        let minesGameFinished = false;
        let minesCount = 3;
        let minesOpenedCells = 0;
        let minesTotalCells = 25;
        let minesCurrentMultiplier = 1.0;
        let minesFlagMode = false;
        let minesMines = [];
        let minesGridState = [];
        let minesGameStarted = false;
        
        // üîß –ü–û–î–ö–†–£–¢–ö–ê: –®–∞–Ω—Å –ø—Ä–æ–∏–≥—Ä—ã—à–∞ 80% –≤–º–µ—Å—Ç–æ 75%
        const MINE_HIT_CHANCE = 0.80;
        const MINE_AVOID_CHANCE = 0.20;

        // üîß –ü–û–î–ö–†–£–¢–ö–ê: –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏
        const MINES_MULTIPLIERS = {
            1: 1.10,   2: 1.12,   3: 1.14,   4: 1.16,   5: 1.18,
            6: 1.20,   7: 1.22,   8: 1.24,   9: 1.26,   10: 1.28,
            11: 1.30,  12: 1.32,  13: 1.34,  14: 1.36,  15: 1.38,
            16: 1.40,  17: 1.42,  18: 1.44,  19: 1.46,  20: 1.48,
            21: 1.50,  22: 1.52,  23: 1.54,  24: 1.56
        };
        
        const MINES_MIN_BET = 0.3;
        
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        function init() {
            updateMinesDisplay();
            updateMinesMultiplierInfo();
            createMinesGrid();
            updateMinesGameInfo();
            updateBalanceDisplay();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—Ç–∞–≤–∫—É
            document.getElementById('minesBetInput').min = MINES_MIN_BET;
            document.getElementById('minesBetInput').value = minesCurrentBet;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–∞
            const userAvatar = document.querySelector('.user-avatar');
            if (userAvatar && userAvatar.innerHTML === '') {
                userAvatar.innerHTML = '<div style="position: absolute; width: 100%; height: 100%; background: white; mask: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>\') no-repeat center; mask-size: 24px;"></div>';
            }
            
            setupEventListeners();
        }

        function updateBalanceDisplay() {
            document.getElementById('balanceAmount').textContent = window.getBalance().toFixed(2) + ' TON';
        }

        // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ====================
        function setupEventListeners() {
            // –°–ª–∞–π–¥–µ—Ä –º–∏–Ω
            document.getElementById('minesSlider').addEventListener('input', () => {
                minesCount = parseInt(document.getElementById('minesSlider').value);
                document.getElementById('minesCount').textContent = minesCount;
                updateMinesDisplay();
                updateMinesMultiplierInfo();
                
                if (!minesGameActive) {
                    resetMinesGame();
                }
            });
            
            // –í–≤–æ–¥ —Å—Ç–∞–≤–∫–∏ —á–µ—Ä–µ–∑ –ø–æ–ª–µ
            document.getElementById('minesBetInput').addEventListener('input', () => {
                let value = parseFloat(document.getElementById('minesBetInput').value);
                if (isNaN(value) || value < MINES_MIN_BET) {
                    value = MINES_MIN_BET;
                    document.getElementById('minesBetInput').value = value;
                }
                
                value = Math.round(value * 10) / 10;
                document.getElementById('minesBetInput').value = value;
                
                document.querySelectorAll('.mines-bet-btn').forEach(btn => btn.classList.remove('active'));
            });
            
            // –ö–Ω–æ–ø–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç–∞–≤–∫–∏
            document.getElementById('minesSetBetButton').addEventListener('click', setMinesCurrentBet);
            
            // –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä—ã—Ö —Å—Ç–∞–≤–æ–∫
            document.querySelectorAll('.mines-bet-btn').forEach(button => {
                button.addEventListener('click', () => {
                    if (minesGameActive) return;
                    
                    const betValue = parseFloat(button.dataset.bet);
                    document.getElementById('minesBetInput').value = betValue;
                    setMinesCurrentBet();
                    
                    document.querySelectorAll('.mines-bet-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });
            
            // –ö–Ω–æ–ø–∫–∞ —Ñ–ª–∞–≥–∞
            document.getElementById('minesFlagButton').addEventListener('click', () => {
                if (!minesGameActive) {
                    window.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É!', 'info');
                    return;
                }
                
                minesFlagMode = !minesFlagMode;
                document.getElementById('minesFlagButton').classList.toggle('active', minesFlagMode);
                
                window.showNotification(minesFlagMode ? '–†–µ–∂–∏–º —Ñ–ª–∞–≥–∞ –≤–∫–ª—é—á–µ–Ω' : '–†–µ–∂–∏–º —Ñ–ª–∞–≥–∞ –≤—ã–∫–ª—é—á–µ–Ω', 'info');
            });
            
            // –ö–Ω–æ–ø–∫–∞ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã
            document.getElementById('minesStartButton').addEventListener('click', () => {
                if (minesGameActive) {
                    resetMinesGame();
                    return;
                }
                
                if (minesCurrentBet < MINES_MIN_BET) {
                    window.showNotification(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${MINES_MIN_BET} TON!`, 'lose');
                    return;
                }
                
                if (minesCurrentBet > window.getBalance()) {
                    window.showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!', 'lose');
                    return;
                }
                
                startMinesGame();
            });
            
            // –ö–Ω–æ–ø–∫–∞ –≤—ã–≤–æ–¥–∞
            document.getElementById('minesCashoutButton').addEventListener('click', () => {
                if (!minesGameActive || !minesGameStarted) {
                    window.showNotification('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É!', 'info');
                    return;
                }
                
                cashoutMines();
            });
        }

        // ==================== –õ–û–ì–ò–ö–ê –ò–ì–†–´ ====================
        function createMinesGrid() {
            const minesGrid = document.getElementById('minesGrid');
            minesGrid.innerHTML = '';
            minesGridState = [];
            
            for (let i = 0; i < minesTotalCells; i++) {
                const cell = document.createElement('div');
                cell.className = 'mines-cell';
                cell.dataset.index = i;
                cell.dataset.state = 'hidden';
                
                cell.addEventListener('click', () => handleMinesCellClick(i));
                cell.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    handleMinesCellRightClick(i);
                });
                
                minesGrid.appendChild(cell);
                minesGridState.push({
                    index: i,
                    state: 'hidden',
                    isMine: false,
                    isFlag: false,
                    hasGem: Math.random() > 0.98
                });
            }
            
            document.getElementById('minesTotalCells').textContent = minesTotalCells;
        }

        function generateMines(firstClickIndex) {
            minesMines = [];
            const availableCells = Array.from({ length: minesTotalCells }, (_, i) => i);
            
            const firstClickIndexInArray = availableCells.indexOf(firstClickIndex);
            if (firstClickIndexInArray !== -1) {
                availableCells.splice(firstClickIndexInArray, 1);
            }
            
            for (let i = 0; i < minesCount; i++) {
                if (availableCells.length === 0) break;
                
                const randomIndex = Math.floor(Math.random() * availableCells.length);
                const mineIndex = availableCells[randomIndex];
                minesMines.push(mineIndex);
                availableCells.splice(randomIndex, 1);
                
                minesGridState[mineIndex].isMine = true;
                minesGridState[mineIndex].hasGem = false;
            }
        }

        function startMinesGame() {
            if (minesGameActive) return;
            
            window.updateBalance(-minesCurrentBet);
            updateBalanceDisplay();
            
            minesGameActive = true;
            minesGameStarted = false;
            minesGameFinished = false;
            minesOpenedCells = 0;
            minesCurrentMultiplier = 1.0;
            minesFlagMode = false;
            
            createMinesGrid();
            updateMinesGameState();
            updateMinesPotentialWin();
            
            document.getElementById('minesStartButton').innerHTML = '<span class="mines-control-icon mines-start-icon"></span>–°–±—Ä–æ—Å –∏–≥—Ä—ã';
            document.getElementById('minesCashoutButton').disabled = false;
            document.getElementById('minesFlagButton').disabled = false;
            document.getElementById('minesSlider').disabled = true;
            document.getElementById('minesBetInput').disabled = true;
            document.getElementById('minesSetBetButton').disabled = true;
            document.querySelectorAll('.mines-bet-btn').forEach(btn => btn.disabled = true);
            
            window.showNotification('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –∫–ª–µ—Ç–∫–∏', 'info');
        }

        function handleMinesCellClick(cellIndex) {
            if (!minesGameActive || minesGameFinished) return;
            
            const cell = minesGridState[cellIndex];
            const cellElement = document.getElementById('minesGrid').children[cellIndex];
            
            if (cell.state !== 'hidden') return;
            
            if (!minesGameStarted) {
                generateMines(cellIndex);
                minesGameStarted = true;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ –º–∏–Ω–æ–π
            if (cell.isMine) {
                const willHitMine = Math.random() < MINE_HIT_CHANCE;
                
                if (willHitMine) {
                    minesGameFinished = true;
                    cell.state = 'mine';
                    cellElement.classList.add('mine', 'opened', 'revealed');
                    cellElement.dataset.state = 'mine';
                    
                    revealAllMines();
                    updateMinesGameState();
                    endMinesGame(false);
                    return;
                } else {
                    cell.state = 'opened';
                    cellElement.classList.add('opened', 'revealed', 'empty');
                    cellElement.dataset.state = 'opened';
                    minesOpenedCells++;
                    
                    minesCurrentMultiplier *= (MINES_MULTIPLIERS[minesCount] * 0.85);
                    minesCurrentMultiplier = Math.round(minesCurrentMultiplier * 100) / 100;
                    
                    window.showNotification('üéâ –£–¥–∞—á–∞! –í—ã –∏–∑–±–µ–∂–∞–ª–∏ –º–∏–Ω—ã!', 'win');
                }
            } else {
                cell.state = 'opened';
                cellElement.classList.add('opened', 'revealed');
                cellElement.dataset.state = 'opened';
                
                if (cell.hasGem && Math.random() < 0.05) {
                    cellElement.classList.add('gem');
                    window.showNotification('üíé –ù–∞–π–¥–µ–Ω –∞–ª–º–∞–∑! –ú–Ω–æ–∂–∏—Ç–µ–ª—å +5%', 'info');
                    minesCurrentMultiplier *= 1.05;
                } else {
                    cellElement.classList.add('empty');
                }
                
                minesOpenedCells++;
                minesCurrentMultiplier *= MINES_MULTIPLIERS[minesCount] * 0.95;
                minesCurrentMultiplier = Math.round(minesCurrentMultiplier * 100) / 100;
            }
            
            const maxSafeCells = minesTotalCells - minesCount;
            if (minesOpenedCells >= maxSafeCells) {
                minesGameFinished = true;
                revealAllMines();
                updateMinesGameState();
                
                const winAmount = Math.round(minesCurrentBet * minesCurrentMultiplier * 10) / 10;
                window.updateBalance(winAmount);
                updateBalanceDisplay();
                
                window.showNotification(`üéâ –í—ã –æ—Ç–∫—Ä—ã–ª–∏ –≤—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏! –í—ã–∏–≥—Ä—ã—à: ${winAmount.toFixed(1)} TON!`, 'win');
                endMinesGame(true);
                return;
            }
            
            updateMinesGameState();
            updateMinesPotentialWin();
            
            cellElement.classList.add('pulse');
            setTimeout(() => cellElement.classList.remove('pulse'), 500);
        }

        function handleMinesCellRightClick(cellIndex) {
            if (!minesGameActive || minesGameFinished) return;
            
            const cell = minesGridState[cellIndex];
            const cellElement = document.getElementById('minesGrid').children[cellIndex];
            
            if (cell.state === 'opened') return;
            
            if (cell.state === 'hidden') {
                cell.state = 'flag';
                cell.isFlag = true;
                cellElement.classList.add('flag');
                cellElement.dataset.state = 'flag';
            } else if (cell.state === 'flag') {
                cell.state = 'hidden';
                cell.isFlag = false;
                cellElement.classList.remove('flag');
                cellElement.dataset.state = 'hidden';
            }
            
            cellElement.classList.add('pulse');
            setTimeout(() => cellElement.classList.remove('pulse'), 300);
        }

        function cashoutMines() {
            if (!minesGameActive || !minesGameStarted || minesGameFinished) return;
            
            minesGameFinished = true;
            
            const winAmount = Math.round(minesCurrentBet * minesCurrentMultiplier * 10) / 10;
            window.updateBalance(winAmount);
            
            updateBalanceDisplay();
            revealAllMines();
            updateMinesGameState();
            
            window.showNotification(`üéâ –í—ã –∑–∞–±—Ä–∞–ª–∏ ${winAmount.toFixed(1)} TON! –ú–Ω–æ–∂–∏—Ç–µ–ª—å: ${minesCurrentMultiplier.toFixed(2)}x`, 'win');
            endMinesGame(true);
        }

        function endMinesGame(isWin) {
            minesGameActive = false;
            minesGameStarted = false;
            
            document.getElementById('minesStartButton').innerHTML = '<span class="mines-control-icon mines-start-icon"></span>–ù–∞—á–∞—Ç—å –∏–≥—Ä—É';
            document.getElementById('minesCashoutButton').disabled = true;
            document.getElementById('minesFlagButton').disabled = true;
            document.getElementById('minesSlider').disabled = false;
            document.getElementById('minesFlagButton').classList.remove('active');
            minesFlagMode = false;
            document.getElementById('minesBetInput').disabled = false;
            document.getElementById('minesSetBetButton').disabled = false;
            document.querySelectorAll('.mines-bet-btn').forEach(btn => btn.disabled = false);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
            const winAmount = isWin ? Math.round(minesCurrentBet * minesCurrentMultiplier * 10) / 10 : 0;
            window.addToHistory('mines', minesCurrentBet, isWin, minesCurrentMultiplier, winAmount);
        }

        function resetMinesGame() {
            minesGameActive = false;
            minesGameStarted = false;
            minesGameFinished = false;
            minesOpenedCells = 0;
            minesCurrentMultiplier = 1.0;
            minesFlagMode = false;
            
            if (!minesGameStarted) {
                window.updateBalance(minesCurrentBet);
                updateBalanceDisplay();
            }
            
            createMinesGrid();
            updateMinesGameState();
            updateMinesPotentialWin();
            
            document.getElementById('minesStartButton').innerHTML = '<span class="mines-control-icon mines-start-icon"></span>–ù–∞—á–∞—Ç—å –∏–≥—Ä—É';
            document.getElementById('minesCashoutButton').disabled = true;
            document.getElementById('minesFlagButton').disabled = false;
            document.getElementById('minesSlider').disabled = false;
            document.getElementById('minesFlagButton').classList.remove('active');
            document.getElementById('minesBetInput').disabled = false;
            document.getElementById('minesSetBetButton').disabled = false;
            document.querySelectorAll('.mines-bet-btn').forEach(btn => btn.disabled = false);
            
            window.showNotification('–ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞', 'info');
        }

        function revealAllMines() {
            for (let i = 0; i < minesTotalCells; i++) {
                const cell = minesGridState[i];
                const cellElement = document.getElementById('minesGrid').children[i];
                
                if (cell.isMine && cell.state !== 'mine') {
                    cell.state = 'mine';
                    cellElement.classList.add('mine', 'revealed');
                    cellElement.dataset.state = 'mine';
                    
                    if (cell.state !== 'opened') {
                        setTimeout(() => {
                            cellElement.classList.add('opened');
                        }, 100 * i);
                    }
                }
            }
        }

        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function updateMinesDisplay() {
            const minesDisplay = document.getElementById('minesDisplay');
            minesDisplay.innerHTML = '';
            
            for (let i = 0; i < 24; i++) {
                const indicator = document.createElement('div');
                indicator.className = 'mine-indicator';
                if (i < minesCount) {
                    indicator.classList.add('active');
                }
                minesDisplay.appendChild(indicator);
            }
        }

        function updateMinesMultiplierInfo() {
            const multiplier = MINES_MULTIPLIERS[minesCount];
            document.getElementById('multiplierPerCell').textContent = multiplier.toFixed(2) + 'x';
        }

        function updateMinesGameState() {
            document.getElementById('minesCellsOpened').textContent = minesOpenedCells;
            document.getElementById('minesCurrentMultiplier').textContent = minesCurrentMultiplier.toFixed(2) + 'x';
            updateMinesPotentialWin();
        }

        function updateMinesPotentialWin() {
            const potentialWin = Math.round(minesCurrentBet * minesCurrentMultiplier * 10) / 10;
            document.getElementById('minesPotentialWin').textContent = potentialWin.toFixed(1) + ' TON';
        }

        function updateMinesGameInfo() {
            document.getElementById('minesCurrentMultiplier').textContent = minesCurrentMultiplier.toFixed(2) + 'x';
            document.getElementById('minesPotentialWin').textContent = (minesCurrentBet * minesCurrentMultiplier).toFixed(1) + ' TON';
        }

        function setMinesCurrentBet() {
            let value = parseFloat(document.getElementById('minesBetInput').value);
            if (isNaN(value) || value < MINES_MIN_BET) {
                value = MINES_MIN_BET;
                document.getElementById('minesBetInput').value = value;
            }
            
            value = Math.round(value * 10) / 10;
            document.getElementById('minesBetInput').value = value;
            minesCurrentBet = value;
            
            updateMinesPotentialWin();
            window.showNotification(`–°—Ç–∞–≤–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: ${value} TON`, 'info');
        }

        // ==================== –ó–ê–ü–£–°–ö ====================
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
